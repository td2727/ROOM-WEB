---
const MAPS_URL = "https://maps.app.goo.gl/ptK9LFwSxjtwNGYT6?g";
const PHONE_TEL = "+59177120636";

// Link del botón "llenar orden"
const ORDER_LINK = "https://oredenes-app.pages.dev/"; // puede ser wa.me, forms, /orden, etc.
---

<header class="topbar">
  <!-- Botón menú (solo móvil) -->
  <button
    class="menuBtn"
    type="button"
    aria-label="Abrir menú"
    aria-controls="mobileMenu"
    aria-expanded="false"
  >
    <span></span><span></span><span></span>
  </button>

  <!-- Menú desktop (centrado) -->
  <nav class="nav desktopNav" aria-label="Navegación principal">
    <a href="#services">Services</a>
    <a href={MAPS_URL} target="_blank" rel="noopener">Ubicación</a>
    <a href={`tel:${PHONE_TEL}`}>Contacto</a>
  </nav>

  <!-- Botón derecho (siempre visible) -->
  <a class="cta" href={ORDER_LINK} target="_blank" rel="noopener">
    llenar orden
  </a>

  <!-- Menú móvil desplegable -->
  <div id="mobileMenu" class="mobileMenu" data-open="false">
    <a class="mItem" href="#services">Services</a>
    <a class="mItem" href={MAPS_URL} target="_blank" rel="noopener">Ubicación</a>
    <a class="mItem" href={`tel:${PHONE_TEL}`}>Contacto</a>
  </div>
</header>

<script is:inline>
  const header = document.querySelector(".topbar");
  const btn = header?.querySelector(".menuBtn");
  const menu = header?.querySelector("#mobileMenu");

  function setOpen(isOpen){
    if (!btn || !menu) return;
    menu.dataset.open = isOpen ? "true" : "false";
    btn.setAttribute("aria-expanded", isOpen ? "true" : "false");
    btn.setAttribute("aria-label", isOpen ? "Cerrar menú" : "Abrir menú");
  }

  btn?.addEventListener("click", () => {
    const openNow = menu?.dataset.open === "true";
    setOpen(!openNow);
  });

  // Cierra al tocar un item
  menu?.addEventListener("click", (e) => {
    const target = e.target;
    if (target && target.tagName === "A") setOpen(false);
  });

  // Cierra al tocar fuera
  document.addEventListener("click", (e) => {
    if (!header || !btn || !menu) return;
    if (!header.contains(e.target)) setOpen(false);
  });

  // Cierra si cambia a desktop
  window.addEventListener("resize", () => {
    if (window.innerWidth > 900) setOpen(false);
  });
</script>

<style>
  .topbar{
    position: relative;
    width:100%;
    height:90px;
    background: url("/images/topbar-bg.png") center / cover no-repeat;
  }

  /* NAV desktop centrado absoluto */
  .desktopNav{
    position:absolute;
    left:50%;
    top:50%;
    transform: translate(-50%, -50%);
    display:flex;
    gap:28px;
    align-items:center;
  }

  .desktopNav a{
    color:#000;
    text-decoration:none;
    font-size:13px;
    font-weight:500;
    padding:6px 10px;
    border-radius:6px;
    background: rgba(255,255,255,.70);
  }

  .desktopNav a:hover{
    background: rgba(255,255,255,.90);
  }

  /* CTA derecha (siempre visible) */
  .cta{
    position:absolute;
    right:32px;
    top:50%;
    transform: translateY(-50%);
    background:#ff6a00;
    color:#111;
    padding:10px 18px;
    border-radius:8px;
    font-weight:700;
    font-size:12px;
    text-decoration:none;
    box-shadow: 0 6px 16px rgba(0,0,0,.35);
    white-space: nowrap;
  }

  /* Botón menú (hamburguesa) */
  .menuBtn{
    position:absolute;
    left:16px;
    top:50%;
    transform: translateY(-50%);
    width:40px;
    height:40px;
    border-radius:10px;
    border: 1px solid rgba(255,255,255,.35);
    background: rgba(0,0,0,.25);
    display:none; /* solo móvil */
    align-items:center;
    justify-content:center;
    gap:5px;
    padding: 0;
    cursor:pointer;
  }
  .menuBtn span{
    display:block;
    width:18px;
    height:2px;
    background:#fff;
    opacity:.95;
  }

  /* Menú móvil desplegable */
  .mobileMenu{
    position:absolute;
    left:12px;
    top: calc(100% + 10px);
    width: 220px;
    background: rgba(15,15,16,.96);
    border: 1px solid rgba(255,255,255,.12);
    border-radius: 14px;
    padding: 10px;
    box-shadow: 0 18px 40px rgba(0,0,0,.45);
    display:none;
  }
  .mobileMenu[data-open="true"]{
    display:block;
  }
  .mItem{
    display:block;
    padding: 10px 10px;
    border-radius: 10px;
    text-decoration:none;
    color:#fff;
    font-size: 13px;
    opacity:.95;
  }
  .mItem:hover{
    background: rgba(255,255,255,.08);
    opacity:1;
  }

  /* MÓVIL */
  @media (max-width: 900px){
    .topbar{ height:80px; }
    .desktopNav{ display:none; }      /* ocultamos menú desktop */
    .menuBtn{ display:flex; }        /* mostramos hamburguesa */
    .cta{
      right:14px;
      padding:8px 12px;
      font-size:11px;
    }
  }
</style>
